services:
  chiffon-executor:
    build:
      context: .
      dockerfile: Dockerfile.executor
    environment:
      CHIFFON_EXECUTOR_TOKEN: ${CHIFFON_EXECUTOR_TOKEN}
      PROJECT: ${PROJECT}
      REPO_PATH: /work
      QUEUE_PATH: /work/tasks/queue
      CRON_SCHEDULE: "*/30 * * * *"
      EXECUTION_MODE: cron
      LLAMA_SERVER_URL: ${LLAMA_SERVER_URL:-http://llamacpp:8000}
      GITEA_BASE_URL: ${GITEA_BASE_URL:-https://code.klsll.com}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ${REPO_PATH:-.}:/work
    restart: unless-stopped
